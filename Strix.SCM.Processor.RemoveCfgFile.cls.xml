<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="Strix.SCM.Processor.RemoveCfgFile">
<Description>
Removes the SCM configuration file from the release.</Description>
<Super>Strix.SCM.Processor.Base</Super>
<TimeCreated>64374,71436.986665</TimeCreated>

<Parameter name="HandlerType">
<Description>
This processor works on a release.</Description>
<Default>Release</Default>
</Parameter>

<UDLText name="T">
<Content><![CDATA[
// =====

]]></Content>
</UDLText>

<Method name="Run">
<FormalSpec>Revision:%String,Directory:%String</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Set ConfigFileName = ##class(%File).GetFilename(..Project.ConfigFilePath)
	Set ConfigFilePath = ##class(%File).SubDirectoryName(Directory, ConfigFileName)
	
	; Windows 10 Version 10.0.16299: sometimes file appears not there
	; (yet). Wait a while to be sure.
	For i = 1:1:5 Hang 1 If ##class(%File).Exists(ConfigFilePath) Quit
	
	If '##class(%File).Exists(ConfigFilePath) {
		Quit $$$BuildErr("Error: configuration file '{}' not found.", , ConfigFilePath)
	}
	
	Do ..Write("Removing config file "_ConfigFilePath)
	Set rc = ##class(%File).Delete(ConfigFilePath, .ec)
	If 'rc Quit $$$BuildErr("Error {} deleting {}.", , ec, ConfigFilePath)
	
	Quit $$$OK
]]></Implementation>
</Method>
</Class>
</Export>
